"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[1325],{79743:function(e,a,n){n.r(a),n.d(a,{_frontmatter:function(){return d},default:function(){return g}});var t=n(58168),i=n(80045),o=(n(88763),n(15680)),s=n(83407);const p=["components"],d={},r=(l="InlineAlert",function(e){return console.warn("Component "+l+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.mdx)("div",e)});var l;const m={_frontmatter:d},c=s.A;function g(e){let{components:a}=e,n=(0,i.A)(e,p);return(0,o.mdx)(c,(0,t.A)({},m,n,{components:a,mdxType:"MDXLayout"}),(0,o.mdx)("h1",{id:"using-the-firefly-expand-image-api"},"Using the Firefly Expand Image API"),(0,o.mdx)("p",null,"Learn how to use the Expand Image API in your code workflows. "),(0,o.mdx)("h2",{id:"introduction"},"Introduction"),(0,o.mdx)("p",null,"Designers often struggle with taking existing media assets and re-purposing them for other sizes and form factors. An original image may be too small, incorrectly oriented, and so forth. With the power of ",(0,o.mdx)("a",{parentName:"p",href:"../api/generative_expand/V3/"},"Firefly's Expand Image API"),', an original asset can be used as a source for generating new variations in multiple sizes, using generative AI to "draw out" from the source. In this guide, you will see how this can be done.'),(0,o.mdx)("h2",{id:"prerequisites"},"Prerequisites"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},"Firefly API credentials. If you don't have them yet, first visit the Firefly Services ",(0,o.mdx)("a",{parentName:"li",href:"../../../guides/get-started.md"},"Getting Started")," guide to obtain a ",(0,o.mdx)("inlineCode",{parentName:"li"},"client_id")," and ",(0,o.mdx)("inlineCode",{parentName:"li"},"client_secret"),"."),(0,o.mdx)("li",{parentName:"ul"},"Node.js installed on your machine and basic familiarity with ",(0,o.mdx)("inlineCode",{parentName:"li"},"JavaScript"),". ",(0,o.mdx)("strong",{parentName:"li"},"Note:")," The code for this guide will make use of the ",(0,o.mdx)("a",{parentName:"li",href:"../api/image_generation/V3/"},"Firefly REST APIs")," via Node.js, but could be written in any language, or with the ",(0,o.mdx)("a",{parentName:"li",href:"https://developer.adobe.com/firefly-services/docs/guides/sdks/"},"SDK"),".")),(0,o.mdx)("h2",{id:"expand-image-api-overview"},"Expand Image API Overview"),(0,o.mdx)("p",null,"Before getting into the code, let's look at how the Expand Image API works at a high-level."),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},"You begin with a source image, which can either be uploaded to Firefly Services, or used with one of the supported cloud storage providers. For this guide, you'll be using a local image uploaded via the ",(0,o.mdx)("a",{parentName:"li",href:"../api/upload_image/"},"Firefly Upload API"),"."),(0,o.mdx)("li",{parentName:"ul"},"You then specify the desired size. This can be any combination of a ",(0,o.mdx)("inlineCode",{parentName:"li"},"height")," and ",(0,o.mdx)("inlineCode",{parentName:"li"},"width")," between ",(0,o.mdx)("inlineCode",{parentName:"li"},"1")," and ",(0,o.mdx)("inlineCode",{parentName:"li"},"3999")," pixels."),(0,o.mdx)("li",{parentName:"ul"},"You can ",(0,o.mdx)("em",{parentName:"li"},"optionally")," specify a text ",(0,o.mdx)("inlineCode",{parentName:"li"},"prompt")," to guide Firefly when creating the expanded region. If not specified, Firefly only uses the source image itself as a guide."),(0,o.mdx)("li",{parentName:"ul"},"An optional ",(0,o.mdx)("inlineCode",{parentName:"li"},"mask")," can be used, as long as it is the same size as specified above."),(0,o.mdx)("li",{parentName:"ul"},"Finally, an optional ",(0,o.mdx)("inlineCode",{parentName:"li"},"placement")," parameter can be provided. By default, Firefly will center the source image in the generated new image, but an ",(0,o.mdx)("inlineCode",{parentName:"li"},"inset")," or ",(0,o.mdx)("inlineCode",{parentName:"li"},"alignment")," value can be used as well. ",(0,o.mdx)("strong",{parentName:"li"},"Note:")," You cannot use the ",(0,o.mdx)("inlineCode",{parentName:"li"},"placement")," parameter when a mask image is provided.")),(0,o.mdx)("h2",{id:"expand-image-call-wrapper"},"Expand Image Call Wrapper"),(0,o.mdx)("p",null,"You will begin with the simplest API operation possible, simply requesting a larger image from a provided source image. From the ",(0,o.mdx)("a",{parentName:"p",href:"../api/generative_expand/V3"},"API Reference"),", you can see that a minimal request body might look like this:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "size": {\n    "width": 2048,\n    "height": 2048\n  },\n  "image": {\n    "source": {\n      "uploadId": "string"\n    },\n  }\n}\n')),(0,o.mdx)("p",null,"where the ",(0,o.mdx)("inlineCode",{parentName:"p"},"uploadId")," will come from an uploaded source image. In this guide, you will use the following image as the source image, so please download it to your local hard drive:"),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"800px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"72.8125%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/ff-services-docs/static/58d2ba2c22b6bb63522a171c0dd5d930/5530d/gen-expand-source.webp 320w","/ff-services-docs/static/58d2ba2c22b6bb63522a171c0dd5d930/0c8fb/gen-expand-source.webp 640w","/ff-services-docs/static/58d2ba2c22b6bb63522a171c0dd5d930/cf465/gen-expand-source.webp 800w"],sizes:"(max-width: 800px) 100vw, 800px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/ff-services-docs/static/58d2ba2c22b6bb63522a171c0dd5d930/8980b/gen-expand-source.jpg 320w","/ff-services-docs/static/58d2ba2c22b6bb63522a171c0dd5d930/56d4e/gen-expand-source.jpg 640w","/ff-services-docs/static/58d2ba2c22b6bb63522a171c0dd5d930/a24e6/gen-expand-source.jpg 800w"],sizes:"(max-width: 800px) 100vw, 800px",type:"image/jpeg"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/ff-services-docs/static/58d2ba2c22b6bb63522a171c0dd5d930/a24e6/gen-expand-source.jpg",alt:"Source image",title:"Source image",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("p",null,"This source image will be uploaded using ",(0,o.mdx)("a",{parentName:"p",href:"../api/upload_image/"},"Firefly's Upload API")," via the ",(0,o.mdx)("inlineCode",{parentName:"p"},"uploadImage()")," provided in the ",(0,o.mdx)("a",{parentName:"p",href:"#complete-source-code"},"complete source code")," section. "),(0,o.mdx)(r,{variant:"success",slots:"title, text",mdxType:"InlineAlert"}),(0,o.mdx)("p",null,"TIP"),(0,o.mdx)("p",null,"We recommend you refer to the ",(0,o.mdx)("a",{parentName:"p",href:"./create-your-first-ff-application.md"},"Create your First Firefly Application")," guide for a step-by-step walkthrough on the utility methods used in the how-to guides for authenticating via ",(0,o.mdx)("inlineCode",{parentName:"p"},"getAccessToken()"),", uploading images for use in the calls via ",(0,o.mdx)("inlineCode",{parentName:"p"},"uploadImage()"),", and for downloading the generated results via",(0,o.mdx)("inlineCode",{parentName:"p"},"downloadFile()"),"."),(0,o.mdx)("p",null,"Now, you can wrap the ",(0,o.mdx)("a",{parentName:"p",href:"../api/generative_expand/V3"},"Expand Image API")," call in a simple utility function like so:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"async function genExpand(imageId, width, height, id, token) {\n\n    let body = {\n        numVariations:1,\n        size:{\n            width,\n            height\n        },\n        image: {\n            source: {\n                uploadId: imageId\n            }\n        }\n    }\n\n    let req = await fetch('https://firefly-api.adobe.io/v3/images/expand', {\n        method:'POST',\n        headers: {\n            'X-Api-Key':id, \n            'Authorization':`Bearer ${token}`,\n            'Content-Type':'application/json'\n        }, \n        body: JSON.stringify(body)\n    });\n\n    return await req.json();\n}\n")),(0,o.mdx)("p",null,"and then call it with:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"let result = await genExpand(sourceImage, 2048, 2048, CLIENT_ID, token);\n")),(0,o.mdx)("h4",{id:"generated-result"},"Generated Result"),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"800px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"100%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/ff-services-docs/static/c47bef06c68d5604be760e1b27e1997e/5530d/gen-expand.webp 320w","/ff-services-docs/static/c47bef06c68d5604be760e1b27e1997e/0c8fb/gen-expand.webp 640w","/ff-services-docs/static/c47bef06c68d5604be760e1b27e1997e/cf465/gen-expand.webp 800w"],sizes:"(max-width: 800px) 100vw, 800px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/ff-services-docs/static/c47bef06c68d5604be760e1b27e1997e/8980b/gen-expand.jpg 320w","/ff-services-docs/static/c47bef06c68d5604be760e1b27e1997e/56d4e/gen-expand.jpg 640w","/ff-services-docs/static/c47bef06c68d5604be760e1b27e1997e/a24e6/gen-expand.jpg 800w"],sizes:"(max-width: 800px) 100vw, 800px",type:"image/jpeg"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/ff-services-docs/static/c47bef06c68d5604be760e1b27e1997e/a24e6/gen-expand.jpg",alt:"Generative expand result",title:"Generative expand result",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("h2",{id:"adding-a-prompt"},"Adding a Prompt"),(0,o.mdx)("p",null,"In this step, you will support the addition of a ",(0,o.mdx)("inlineCode",{parentName:"p"},"prompt")," parameter which can be supplied to help guide the Firely Image model in what's generated with the expansion call. In this step, you will expand the function from above to support a ",(0,o.mdx)("inlineCode",{parentName:"p"},"prompt")," as an optional argument. When specified, it will be passed along in the body of the API call."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"async function genExpand(imageId, width, height, id, token, prompt) {\n\n    let body = {\n        numVariations:1,\n        size:{\n            width,\n            height\n        },\n        image: {\n            source: {\n                uploadId: imageId\n            }\n        }\n    }\n\n    if(prompt) body.prompt = prompt;\n\n    let req = await fetch('https://firefly-api.adobe.io/v3/images/expand', {\n        method:'POST',\n        headers: {\n            'X-Api-Key':id, \n            'Authorization':`Bearer ${token}`,\n            'Content-Type':'application/json'\n        }, \n        body: JSON.stringify(body)\n    });\n\n    return await req.json();\n}\n")),(0,o.mdx)("p",null,"It can then be called such as in the following, with a sample text prompt of: ",(0,o.mdx)("inlineCode",{parentName:"p"},'"The sun is rising in the background and trees are visible."'),"."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'result = await genExpand(sourceImage, 2048, 2048, CLIENT_ID, token, "The sun is rising in the background and trees are visible.");\n')),(0,o.mdx)("p",null,"An example result when using this prompt is shown below:"),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"800px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"100%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/ff-services-docs/static/68afec06ddadc68ac55a29a261fa5e27/5530d/gen-expand-prompt.webp 320w","/ff-services-docs/static/68afec06ddadc68ac55a29a261fa5e27/0c8fb/gen-expand-prompt.webp 640w","/ff-services-docs/static/68afec06ddadc68ac55a29a261fa5e27/cf465/gen-expand-prompt.webp 800w"],sizes:"(max-width: 800px) 100vw, 800px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/ff-services-docs/static/68afec06ddadc68ac55a29a261fa5e27/8980b/gen-expand-prompt.jpg 320w","/ff-services-docs/static/68afec06ddadc68ac55a29a261fa5e27/56d4e/gen-expand-prompt.jpg 640w","/ff-services-docs/static/68afec06ddadc68ac55a29a261fa5e27/a24e6/gen-expand-prompt.jpg 800w"],sizes:"(max-width: 800px) 100vw, 800px",type:"image/jpeg"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/ff-services-docs/static/68afec06ddadc68ac55a29a261fa5e27/a24e6/gen-expand-prompt.jpg",alt:"Generative expand with prompt result",title:"Generative expand with prompt result",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("p",null,"As you can see, the expansion took the prompt as a guide when expanding the source. Feel free to switch the prompt to something completely different now to compare the results."),(0,o.mdx)("h2",{id:"using-placement-to-control-the-expansion-direction"},"Using Placement to Control the Expansion Direction"),(0,o.mdx)("p",null,'By default, Firefly is going to expand "outwards" treating the source image as the center. There are times, however, when that will not make sense and you need more control over the direction of the expansion. The ',(0,o.mdx)("inlineCode",{parentName:"p"},"placement")," argument can specify either an ",(0,o.mdx)("inlineCode",{parentName:"p"},"inset")," or ",(0,o.mdx)("inlineCode",{parentName:"p"},"alignment")," value. The ",(0,o.mdx)("inlineCode",{parentName:"p"},"inset")," value lets you specify displacement values for ",(0,o.mdx)("inlineCode",{parentName:"p"},"left"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"top"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"right"),", and ",(0,o.mdx)("inlineCode",{parentName:"p"},"bottom")," values, while ",(0,o.mdx)("inlineCode",{parentName:"p"},"alignment")," lets you specify values for ",(0,o.mdx)("inlineCode",{parentName:"p"},"horizontal")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"vertical")," alignment. "),(0,o.mdx)("p",null,"As an example, if you wanted the new image to treat the source as the bottom left corner of the new image, you would add this to the request body:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-json"},'placement: {\n    alignment: {\n        horizontal: "left",\n        vertical: "bottom"\n    }\n}\n')),(0,o.mdx)("p",null,"In this step, you will see an example of this in use after updating the method to support an ",(0,o.mdx)("inlineCode",{parentName:"p"},"alignment")," parameter:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"async function genExpand(imageId, width, height, id, token, prompt, alignment) {\n\n    let body = {\n        numVariations:1,\n        size:{\n            width,\n            height\n        },\n        image: {\n            source: {\n                uploadId: imageId\n            }\n        }\n    }\n\n    if(prompt) body.prompt = prompt;\n    if(alignment) body.placement = { alignment };\n\n    let req = await fetch('https://firefly-api.adobe.io/v3/images/expand', {\n        method:'POST',\n        headers: {\n            'X-Api-Key':id, \n            'Authorization':`Bearer ${token}`,\n            'Content-Type':'application/json'\n        }, \n        body: JSON.stringify(body)\n    });\n\n    return await req.json();\n}\n")),(0,o.mdx)("p",null,"Then, call it with the following snippet:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'result = await genExpand(sourceImage, 2048, 2048, CLIENT_ID, token, \n"The sun is rising in the background and trees are visible.", { horizontal:"left", vertical:"bottom" });\n')),(0,o.mdx)("p",null,"Below is an example result:"),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"800px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"100%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/ff-services-docs/static/21dca958a5dc63a6c41b0a44a3c416c8/5530d/gen-expand-prompt-placement.webp 320w","/ff-services-docs/static/21dca958a5dc63a6c41b0a44a3c416c8/0c8fb/gen-expand-prompt-placement.webp 640w","/ff-services-docs/static/21dca958a5dc63a6c41b0a44a3c416c8/cf465/gen-expand-prompt-placement.webp 800w"],sizes:"(max-width: 800px) 100vw, 800px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/ff-services-docs/static/21dca958a5dc63a6c41b0a44a3c416c8/8980b/gen-expand-prompt-placement.jpg 320w","/ff-services-docs/static/21dca958a5dc63a6c41b0a44a3c416c8/56d4e/gen-expand-prompt-placement.jpg 640w","/ff-services-docs/static/21dca958a5dc63a6c41b0a44a3c416c8/a24e6/gen-expand-prompt-placement.jpg 800w"],sizes:"(max-width: 800px) 100vw, 800px",type:"image/jpeg"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/ff-services-docs/static/21dca958a5dc63a6c41b0a44a3c416c8/a24e6/gen-expand-prompt-placement.jpg",alt:"Generative expand with prompt and placement result",title:"Generative expand with prompt and placement result",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("h2",{id:"complete-source-code"},"Complete Source Code"),(0,o.mdx)("p",null,"The complete source code showing all three variations of expand calls, as well as the utility methods required for authenticating, uploading and downloading files is included below, for reference."),(0,o.mdx)(r,{variant:"warning",slots:"title, text",mdxType:"InlineAlert"}),(0,o.mdx)("p",null,"IMPORTANT"),(0,o.mdx)("p",null,"This ",(0,o.mdx)("inlineCode",{parentName:"p"},"Node.js")," code uses imports and top-level ",(0,o.mdx)("inlineCode",{parentName:"p"},"await"),", so you must either use the ",(0,o.mdx)("inlineCode",{parentName:"p"},".mjs")," extension on your script file, or ensure you have a ",(0,o.mdx)("inlineCode",{parentName:"p"},"package.json")," with ",(0,o.mdx)("inlineCode",{parentName:"p"},'type: "module"'),"."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"import fs from 'fs';\nimport { Readable } from 'stream';\nimport { finished } from 'stream/promises';\n\n/*\n  Set the creds based on environment variables.\n*/\nconst CLIENT_ID = process.env.CLIENT_ID;\nconst CLIENT_SECRET = process.env.CLIENT_SECRET;\n\nasync function getAccessToken(id, secret) {\n\n    const params = new URLSearchParams();\n\n    params.append('grant_type', 'client_credentials');\n    params.append('client_id', id);\n    params.append('client_secret', secret);\n    params.append('scope', 'openid,AdobeID,firefly_enterprise,firefly_api,ff_apis');\n    \n    let resp = await fetch('https://ims-na1-stg1.adobelogin.com/ims/token/v3', \n        { \n            method: 'POST', \n            body: params\n        }\n    );\n\n    let data = await resp.json();\n    return data.access_token;\n}\n\nasync function uploadImage(filePath, fileType, id, token) {\n\n    let stream = fs.createReadStream(filePath);\n    let stats = fs.statSync(filePath);\n    let fileSizeInBytes = stats.size;\n\n    let upload = await fetch('https://firefly-api.adobe.io/v2/storage/image', {\n        method:'POST', \n        headers: {\n            'Authorization':`Bearer ${token}`, \n            'X-API-Key':id, \n            'Content-Type':fileType, \n            'Content-Length':fileSizeInBytes\n        }, \n        duplex:'half', \n        body:stream\n    });\n\n    return await upload.json();\n}\n\nasync function downloadFile(url, filePath) {\n    let res = await fetch(url);\n    const body = Readable.fromWeb(res.body);\n    const download_write_stream = fs.createWriteStream(filePath);\n    return await finished(body.pipe(download_write_stream));\n}\n\nasync function genExpand(imageId, width, height, id, token, prompt, alignment) {\n\n    let body = {\n        numVariations:1,\n        size:{\n            width,\n            height\n        },\n        image: {\n            source: {\n                uploadId: imageId\n            }\n        }\n    }\n\n    if(prompt) body.prompt = prompt;\n    if(alignment) body.placement = { alignment };\n\n    let req = await fetch('https://firefly-api.adobe.io/v3/images/expand', {\n        method:'POST',\n        headers: {\n            'X-Api-Key':id, \n            'Authorization':`Bearer ${token}`,\n            'Content-Type':'application/json'\n        }, \n        body: JSON.stringify(body)\n    });\n\n    return await req.json();\n}\n\nlet token = await getAccessToken(CLIENT_ID, CLIENT_SECRET);\n\nlet upload = await uploadImage('./gen-expand-source.jpg', 'image/jpeg', CLIENT_ID, token);\nlet sourceImage = upload.images[0].id;\n\nlet result = await genExpand(sourceImage, 2048, 2048, CLIENT_ID, token);\nlet fileName = `./output/gen-expand.jpg`;\nawait downloadFile(result.outputs[0].image.url, fileName);\n\nresult = await genExpand(sourceImage, 2048, 2048, CLIENT_ID, token, \"The sun is rising in the background and trees are visible.\");\nfileName = `./output/gen-expand-prompt.jpg`;\nawait downloadFile(result.outputs[0].image.url, fileName);\n\nresult = await genExpand(sourceImage, 2048, 2048, CLIENT_ID, token, \"The sun is rising in the background and trees are visible.\", { horizontal:\"left\", vertical:\"bottom\" });\nfileName = `./output/gen-expand-prompt-placement.jpg`;\nawait downloadFile(result.outputs[0].image.url, fileName);\n")),(0,o.mdx)("h2",{id:"next-steps"},"Next Steps"),(0,o.mdx)("p",null,(0,o.mdx)("a",{parentName:"p",href:"../api/generative_expand/V3/"},"Firefly's Expand Image API")," is a powerful tool to help designers create new variations of their existing media at a large scale, and to be able to have fine-grained control over the result with the options available. Check out the ",(0,o.mdx)("a",{parentName:"p",href:"../api/generative_expand/V3/"},"API Reference")," for more details."))}g.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-firefly-api-guides-how-tos-using-expand-image-md-fecc02ebbd64791e1705.js.map