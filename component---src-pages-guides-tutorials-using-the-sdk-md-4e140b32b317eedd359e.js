"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[5684],{88706:function(e,t,a){a.r(t),a.d(t,{_frontmatter:function(){return d},default:function(){return m}});var n=a(58168),i=a(80045),s=(a(88763),a(15680)),r=a(83407);const o=["components"],d={},p={_frontmatter:d},l=r.A;function m(e){let{components:t}=e,a=(0,i.A)(e,o);return(0,s.mdx)(l,(0,n.A)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,s.mdx)("h1",{id:"getting-started-with-the-firefly-services-sdk"},"Getting Started with the Firefly Services SDK"),(0,s.mdx)("p",null,"As a developer, you have the flexibility to choose how you want to integrate with Firefly Services, tailoring the experience to your specific needs and preferences. "),(0,s.mdx)("h2",{id:"overview"},"Overview"),(0,s.mdx)("p",null,"Whether you prefer the direct control and language-specific implementations provided by ",(0,s.mdx)("a",{parentName:"p",href:"../../firefly-api/guides/api/image_generation/V3/"},"REST APIs")," or the simplified, streamlined approach offered by our ",(0,s.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/firefly-services/docs/guides/sdks/"},"Node SDK"),", Firefly Services has you covered."),(0,s.mdx)("h2",{id:"choosing-the-right-approach-for-your-project"},"Choosing the Right Approach for Your Project"),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("p",{parentName:"li"},(0,s.mdx)("strong",{parentName:"p"},"When to Use REST APIs"),": If you need maximum flexibility, detailed control, and are working in a language other than JavaScript/TypeScript, direct REST API access might be the best choice for you.")),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("p",{parentName:"li"},(0,s.mdx)("strong",{parentName:"p"},"When to Use the Node SDK"),": If you're working in a ",(0,s.mdx)("inlineCode",{parentName:"p"},"Node.js")," environment and want to simplify the integration process, reduce boilerplate code, and speed up development, the Node SDK is the way to go.\nBy offering both direct REST API access and a Node SDK, Firefly Services ensures that you have the tools you need to build powerful integrations in the way that best suits your workflow. "))),(0,s.mdx)("p",null,"Let's explore what you need to get started with your first integration."),(0,s.mdx)("p",null,"The SDK supports Node.js and either JavaScript or TypeScript. While this article will focus on Firefly APIs, the SDK also includes Photoshop and Lightroom APIs."),(0,s.mdx)("h2",{id:"prerequisites"},"Prerequisites"),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},"You will need a set of credentials for Firefly Services. You can get those ",(0,s.mdx)("a",{parentName:"li",href:"../get-started.md"},"here"),".")),(0,s.mdx)("h2",{id:"the-workflow"},"The Workflow"),(0,s.mdx)("p",null,"Before digging into the code, let's break down the process."),(0,s.mdx)("ol",null,(0,s.mdx)("li",{parentName:"ol"},"Add the SDK packages"),(0,s.mdx)("li",{parentName:"ol"},"Setting up authentication"),(0,s.mdx)("li",{parentName:"ol"},"Instantiate Firefly"),(0,s.mdx)("li",{parentName:"ol"},"Generating an Image with a Prompt"),(0,s.mdx)("li",{parentName:"ol"},"Download the Results")),(0,s.mdx)("h2",{id:"step-1-add-the-sdk-packages"},"Step 1: Add the SDK packages"),(0,s.mdx)("p",null,"Let's begin by initializing a new ",(0,s.mdx)("inlineCode",{parentName:"p"},"package.json")," in your prompt with ",(0,s.mdx)("inlineCode",{parentName:"p"},"npm init -y"),". "),(0,s.mdx)("p",null,"Next, you need to add the SDK. As described in the SDK's ",(0,s.mdx)("a",{parentName:"p",href:"https://git.corp.adobe.com/cc-apis/firefly-services-sdk-js/"},"readme"),", there are four individual packages you ",(0,s.mdx)("em",{parentName:"p"},"can")," install:"),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},"The ",(0,s.mdx)("inlineCode",{parentName:"li"},"common APIs")," package is required for authentication, you'll always need this."),(0,s.mdx)("li",{parentName:"ul"},"A package for Firefly API."),(0,s.mdx)("li",{parentName:"ul"},"A package for Photoshop API."),(0,s.mdx)("li",{parentName:"ul"},"A package for Lightroom API.")),(0,s.mdx)("p",null,"For your needs, you only require the common and Firefly APIs. Install them like so:"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-bash"},"npm install @adobe/firefly-services-common-apis\nnpm install @adobe/firefly-apis\n")),(0,s.mdx)("p",null,"Lastly, in order to use top-level await and imports, add a ",(0,s.mdx)("inlineCode",{parentName:"p"},"type")," setting of ",(0,s.mdx)("inlineCode",{parentName:"p"},"module")," to your package.json. Here's a complete example for reference:"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "code",\n  "version": "1.0.0",\n  "type":"module",\n  "description": "",\n  "main": "firefly.js",\n  "scripts": {\n    "test": "echo \\"Error: no test specified\\" && exit 1"\n  },\n  "keywords": [],\n  "author": "",\n  "license": "ISC",\n  "dependencies": {\n    "@adobe/firefly-apis": "^1.0.0",\n    "@adobe/firefly-services-common-apis": "^1.0.0"\n  }\n}\n')),(0,s.mdx)("h2",{id:"step-2-setting-up-authentication"},"Step 2: Setting up Authentication"),(0,s.mdx)("p",null,"Let's begin with a simple example, generating an image from a prompt. Our code needs to begin with authentication and creating the Firefly object:"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"import { FireflyClient } from '@adobe/firefly-apis';\n\nconst authOptions = {\n    autoRefresh: true,\n    serviceEnvironment:'stage'\n};\n\nconst firefly = await FireflyClient.createWithCredentials(process.env.CLIENT_ID, process.env.CLIENT_SECRET, authOptions);\n")),(0,s.mdx)("p",null,"In the code above, you need to use two environment variables (",(0,s.mdx)("inlineCode",{parentName:"p"},"CLIENT_ID")," and ",(0,s.mdx)("inlineCode",{parentName:"p"},"CLIENT_SECRET"),") and pass them to the ",(0,s.mdx)("inlineCode",{parentName:"p"},"createWithCredentials")," method. Note that for the bug bash, the ",(0,s.mdx)("inlineCode",{parentName:"p"},"authOptions")," object specified above is required."),(0,s.mdx)("h2",{id:"step-3-instantiate-firefly"},"Step 3: Instantiate Firefly"),(0,s.mdx)("p",null,"The next part is much more simple, creating an instance of the Firefly SDK:"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"import { FireflyClient } from '@adobe/firefly-apis';\n\nconst firefly = new FireflyClient(config);\n")),(0,s.mdx)("h2",{id:"step-4-generating-an-image-with-a-prompt"},"Step 4: Generating an Image with a Prompt"),(0,s.mdx)("p",null,"With authentication done and the Firefly client created, how do you generate images for a prompt? It takes all of one line!"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"const resp = await firefly.generateImages({prompt:'a cat riding a unicorn headed into the sunset, dramatic pose'});\n")),(0,s.mdx)("p",null,"As a reminder, the Firefly API can accept ",(0,s.mdx)("em",{parentName:"p"},"many")," parameters, and they're all supported by the SDK, but in this case, you have passed just a prompt and the number of images required. The result of the SDK call is twofold - first a ",(0,s.mdx)("inlineCode",{parentName:"p"},"result")," JSON object that matches what the REST API returns, and secondly a set of ",(0,s.mdx)("inlineCode",{parentName:"p"},"headers")," you can inspect if needed."),(0,s.mdx)("p",null,"Here's the JSON returned in the ",(0,s.mdx)("inlineCode",{parentName:"p"},"result")," key:"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-json"},'{\n        "size": {\n                "width": 2048,\n                "height": 2048\n        },\n        "outputs": [\n                {\n                        "seed": 85987617,\n                        "image": {\n                                "url": "https://pre-signed-firefly-stage.s3-accelerate.amazonaws.com/images/2df5e7ac-cd6a-42c1-b407-e9c316006a55?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIA55EBG7KCZFCHQDZT%2F20240606%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240606T144529Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=cbcdb705aa5f2ceeefb524c31b96715381f1f8e5980126f5051b7b289bfc31e3"\n                        }\n                }\n        ],\n        "contentClass": "photo"\n}\n')),(0,s.mdx)("h2",{id:"step-5-download-the-results"},"Step 5: Download the Results"),(0,s.mdx)("p",null,"Currently, the SDK doesn't support downloading the images for you, but this can be done with a few lines of code. Here's the required import and a basic utility function to download a URL to a path:"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"import fs from 'fs';\nimport { Readable } from 'stream';\nimport { finished } from 'stream/promises';\n\nasync function downloadFile(url, filePath) {\n    let res = await fetch(url);\n    const body = Readable.fromWeb(res.body);\n    const download_write_stream = fs.createWriteStream(filePath);\n    return await finished(body.pipe(download_write_stream));\n}\n")),(0,s.mdx)("p",null,"To put it all together, here's a complete script that handles the authentication, generating images based on our prompt, and then saving each result to the file system using the results ",(0,s.mdx)("inlineCode",{parentName:"p"},"seed")," value."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"import fs from 'fs';\nimport { Readable } from 'stream';\nimport { finished } from 'stream/promises';\n\nimport { FireflyClient } from '@adobe/firefly-apis';\n\nasync function downloadFile(url, filePath) {\n    let res = await fetch(url);\n    const body = Readable.fromWeb(res.body);\n    const download_write_stream = fs.createWriteStream(filePath);\n    return await finished(body.pipe(download_write_stream));\n}\n\nconst authOptions = {\n    autoRefresh: true,\n    serviceEnvironment:'stage'\n};\n\nconst firefly = await FireflyClient.createWithCredentials(process.env.CLIENT_ID, process.env.CLIENT_SECRET, authOptions);\n\nconst resp = await firefly.generateImages({prompt:'a cat riding a unicorn headed into the sunset, dramatic pose', n:4});\n\nfor(let output of resp.result.outputs) {\n    let fileName = `./${output.seed}.jpg`;\n    await downloadFile(output.image.url, fileName);\n}\n\n")),(0,s.mdx)("p",null,"And here's one of the sample results of our prompt:"),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"650px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"100%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/ff-services-docs/static/d130aa111445e15c40ed54570c2f718f/5530d/shot1.webp 320w","/ff-services-docs/static/d130aa111445e15c40ed54570c2f718f/0c8fb/shot1.webp 640w","/ff-services-docs/static/d130aa111445e15c40ed54570c2f718f/309d5/shot1.webp 650w"],sizes:"(max-width: 650px) 100vw, 650px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/ff-services-docs/static/d130aa111445e15c40ed54570c2f718f/8980b/shot1.jpg 320w","/ff-services-docs/static/d130aa111445e15c40ed54570c2f718f/56d4e/shot1.jpg 640w","/ff-services-docs/static/d130aa111445e15c40ed54570c2f718f/8ea4d/shot1.jpg 650w"],sizes:"(max-width: 650px) 100vw, 650px",type:"image/jpeg"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/ff-services-docs/static/d130aa111445e15c40ed54570c2f718f/8ea4d/shot1.jpg",alt:"Prompt generated image",title:"Prompt generated image",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("h2",{id:"additional-workflow-working-with-reference-images"},"Additional workflow: Working with Reference Images"),(0,s.mdx)("p",null,"One of the benefits of having a Firefly SDK is how easy it is to build more complex workflows. To demonstrate a simple example of this, let's enhance our simple text-to-image prompt example by using a reference image. Reference images help guide the visual style of the generated result."),(0,s.mdx)("p",null,"In order for this to work, you first need your reference image. You can use this:"),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"650px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"100%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/ff-services-docs/static/d130aa111445e15c40ed54570c2f718f/5530d/shot1.webp 320w","/ff-services-docs/static/d130aa111445e15c40ed54570c2f718f/0c8fb/shot1.webp 640w","/ff-services-docs/static/d130aa111445e15c40ed54570c2f718f/309d5/shot1.webp 650w"],sizes:"(max-width: 650px) 100vw, 650px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/ff-services-docs/static/d130aa111445e15c40ed54570c2f718f/8980b/shot1.jpg 320w","/ff-services-docs/static/d130aa111445e15c40ed54570c2f718f/56d4e/shot1.jpg 640w","/ff-services-docs/static/d130aa111445e15c40ed54570c2f718f/8ea4d/shot1.jpg 650w"],sizes:"(max-width: 650px) 100vw, 650px",type:"image/jpeg"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/ff-services-docs/static/d130aa111445e15c40ed54570c2f718f/8ea4d/shot1.jpg",alt:"Generated image",title:"Generated image",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("p",null,"Skipping over the authentication bits that is already covered, the first change is to upload our reference image:"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"const uploadResp = await firefly.upload(new Blob([await fs.readFile('./source_image.jpg')],{type:'image/jpeg'}));\n")),(0,s.mdx)("p",null,"The ",(0,s.mdx)("inlineCode",{parentName:"p"},"upload")," SDK method requires a Blob which is wrapped around a file read on ",(0,s.mdx)("inlineCode",{parentName:"p"},"./source_image.jpg"),". As with the previous SDK example, the response includes a JSON result as well as the headers, with the JSON matching what you get when using the REST API. As an example:"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "images": [\n        {\n        "id": "9f54159b-f0e9-4696-b4f5-f543a3fb90c0"\n        }\n    ]\n}\n')),(0,s.mdx)("p",null,"Using that reference when generating images looks like so:"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"const resp = await firefly.generateImages({\n    prompt:'a cat riding a unicorn headed into the sunset, dramatic pose',      style: {\n        imageReference: {\n            source: {\n                uploadId:uploadResp.result.images[0].id\n            }\n        }\n    }\n});\n")),(0,s.mdx)("p",null,"Compared to the previous version of the SDK, the ",(0,s.mdx)("inlineCode",{parentName:"p"},"style")," attribute has been added and passed in the ",(0,s.mdx)("inlineCode",{parentName:"p"},"imageReference")," value. The changes to the generated images are immediately recognizable as being based on the style of the reference image."),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"650px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"100%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/ff-services-docs/static/de3a55c6fdbfea7694f2e68a798f71c3/5530d/shot2.webp 320w","/ff-services-docs/static/de3a55c6fdbfea7694f2e68a798f71c3/0c8fb/shot2.webp 640w","/ff-services-docs/static/de3a55c6fdbfea7694f2e68a798f71c3/309d5/shot2.webp 650w"],sizes:"(max-width: 650px) 100vw, 650px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/ff-services-docs/static/de3a55c6fdbfea7694f2e68a798f71c3/8980b/shot2.jpg 320w","/ff-services-docs/static/de3a55c6fdbfea7694f2e68a798f71c3/56d4e/shot2.jpg 640w","/ff-services-docs/static/de3a55c6fdbfea7694f2e68a798f71c3/8ea4d/shot2.jpg 650w"],sizes:"(max-width: 650px) 100vw, 650px",type:"image/jpeg"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/ff-services-docs/static/de3a55c6fdbfea7694f2e68a798f71c3/8ea4d/shot2.jpg",alt:"Second generated image",title:"Second generated image",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("h2",{id:"next-steps"},"Next Steps"),(0,s.mdx)("p",null,"Now that you've seen how the SDK can ","*","greatly","*"," simplify your Firefly Services workflows, take a look over the ",(0,s.mdx)("a",{parentName:"p",href:"https://github.com/Firefly-Services/firefly-services-sdk-jshttps://github.com/Firefly-Services/firefly-services-sdk-js"},"Github repository")," and check out the docs and other samples as well."))}m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-tutorials-using-the-sdk-md-4e140b32b317eedd359e.js.map